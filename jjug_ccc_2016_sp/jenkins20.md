Jenkins 2.0 #ccc_gh3
====================

# 概要
- Speaker: @kohsukekawa (CloudBees, Inc)
- Title: Jenkins 2.0

# 現状
- かなり使われてる
    - マスター10万台、スレーブ40万台
- 開発がバザールっぽくなってる
- 10周年のとき、「次の10年はどうする」
- Jenkins 2.0

# Jenkins2.0
## パイプライン
### 思想
#### 自動化適用範囲の広がりと重なり(点から面)

- いろんな個々のテスト、テスト以外の作業に広ってる
    - Unit Test
    - Performance Test
	- deploy
	- ...
	
個々の独立した作業が、プラットフォーム（Jenkinsとか）の上で繋がってきた	。
使うヒトも増えた、役割も重くなった（開発等の中で、ミッションクリティカルになってきた）。

広がりをサポートする。CIサポートから、CDサポートへ。


#### as a code
コードで書いて、GUI操作、状態依存を排除する、Infrastructure as a codeの文脈。

- 変更可視化
- 結果ではなく意図を記録
- 冗長排除
- 大規模運用に耐える

### 概要
#### DSL
DSLで書く。学習コスト下げるように snippetとセットと、それを追加するGUI機能を追加。

DSLで、タスクを「作業ステージと処理」の流れを追加。ステージは、タスクの実施結果の見える化のため。
実行結果として、ステージごとの結果や、実行時間などを見ることができる。

条件分岐構文(if, try-catch, )、環境情報取得(Windowsだったらアレして、Linux系だったらコレして）など充実。

人間の作業を含めることもできる。

#### Github Organization Folder
Githubリポジトリと連携して 設定が入った Jekinsfile を管理できる。
リポジトリを指定すると、Jenkinsfile を見つけてリポジトリを監視する。
branchやpull reqを検知して、pull reqに対してタスク（テストとか）を実行して、結果をissueにポストしたりできる。

#### パイプラインドキュメント
https://jenkins.io/

#### プラグインとパイプライン
sshagentを使って接続するとか、タイムアウト処理とか、プラグイン機能によりDSLでできることが増える。

パイプラインのテンプレート。ベースとなるパイプラインと引数を定義して、子PJではそれを引数的に呼ぶ、
という形で使いまわせる。スケールするパイプライン管理ができる。

### まとめ

- 複雑高度な処理もJenkinsでできるぜ
- テキスト定義なんでバージョン管理できるぜ
- ジョブが多くてもテンプレート機能があるからスケールするぜ
- Jenkins再起動してもパイプライン処理途中から再開できるぜ


## UI改善
使いやすくしたよ。

## 要素組み立てからの脱却
旧来は、機能セット的にはバニラなJenkinsにプラグイン諸々入れて「CIサーバ」に仕立てる、というプロセスが必要。

使う人の裾野も広がったし、最初からある程度使えるようにしないとね。

- おすすめプラグインを最初からつけておく
- ガイド画面を用意してベストプラクティスにユーザに誘導

> IntelliJ IDEAとかもそうでしょ？


標準機能を豊かにして、プラグイン同士の機能の重なり・設定の重なりなどの面倒をなくす。
同じことをするにしても、使い方がヒト、場所によってマチマチ。アドバイスや誘導もしづらい。
メインストリートを用意して、その道の機能テストやドキュメントを充実して使いやすくする。

## ユーザを守る


